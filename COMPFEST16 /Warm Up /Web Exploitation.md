# **Magik**

Pada challenge ini saya diberikan sebuah web page seperti gambar dibawah

![magik1](https://github.com/user-attachments/assets/9920ec4b-29ec-4404-bc2b-ac4894f9a9b6)

beserta source code dari web nya

![image](https://github.com/user-attachments/assets/78d7e1f4-b8a7-44c2-a472-19d71c5e8eb5)

Jika dilihat web page ini tidak ada tempat dimana saya bisa menyisipkan payload saya dan hanya ada kata bertuliskan `Please specify secret in the GET parameter!`

Saya langsung membuka burp suite saya dan mengintercept website nya.

![magik2](https://github.com/user-attachments/assets/6bc64f57-e80c-4f96-a584-eea9977cb449)

Dari sini saya langsung mengirimnya ke repeater dan melakukan analisis pada code nya

dari code nya saya dapat melihat apabila terdapat sebuah condition untuk mendapatkan flag nya

![image](https://github.com/user-attachments/assets/bd16d778-a57b-4cac-ad66-ee9164e9816c)

awalnya saya cukup kebingungan maksud dari hash ini dan angka angka ini. Namun setelah saya pahami lebih dalam lagi dan searching dari google, ternyata angka angka ini adalah `md5` yang cukup sering ditemukan dalam
pertandingan ctf.

![image](https://github.com/user-attachments/assets/58d19ef2-481a-4817-80d5-c9d3c10fe50c)

Di saat saya membuka (link ini)[https://stackoverflow.com/questions/22140204/why-md5240610708-is-equal-to-md5qnkcdzo] saya mendapatkan penjelasan seperti dibawah ini

![image](https://github.com/user-attachments/assets/4d682c37-7d9b-4ddb-ac09-9179c43e7afc)

sesuai yang di jelaskan melalui gambar penjelasan diatas, saya melihat apabila md5 hashnya hanya menggunakan `==` bukan `===` yang mana membuat kedua value dari hash nya akan `0 == 0`.

Lalu jika saya coba md5 angka `240610708` saya baru menyadari bahwa hash value nya akan sama dengan yg condition di sebelahnya

![image](https://github.com/user-attachments/assets/c33e0752-7ebc-47cb-a599-9a8ee38346d4)

Dari sini juga saya dapat memahami apabila untuk mendapatkan flag nya, maka saya harus mencari suatu value yg mirip dengan angka `240610708` dan hash nya bisa disamakan dengan hash md5 dari `240610708`

Dengan adanya condition dari sumber yang saya dapatkan dan juga 'clue' (QNKCDZO) yang saya dapatkan, saya mencari cara untuk mengbypass systemnya.

Saya ingat dari pengalaman pengalaman sebelumnya, pada GET parameternya biasanya setelah tanda `/`, saya bisa menggunakan variable seperti misalkan `?name=haha` untuk dapat mengstore value inputan yang biasa bisa
dijadikan tempat untuk menaruh payload seperti gambar dibawah.

![magik3](https://github.com/user-attachments/assets/31ccb7b2-1eb5-435d-b6b5-3b8d9c4ede29)

Karena variable ini namanya `secret` sesuai dengan source code nya, maka saya langsung membuat variable seperti `/secret=QNKCDZO` untuk kemudian di tamper ke GET parameternya yang membuat saya berhasil mendapatkan
flag dari chall ini

![magik4](https://github.com/user-attachments/assets/4d0b91c6-7d15-4b01-b783-d14938cbb8e7)

**FLAG:** `COMPFEST16{1_h4T3_pHp_lmA000000_8da795d09f}`


# **Pink**

Pada challenge ini saya diberikan sebuah website seperti gambar dibawah

![pink1](https://github.com/user-attachments/assets/7f5c5d1b-e76b-49d2-a731-1be3cab54e19)

dan source code dari web seperti dibawah

![image](https://github.com/user-attachments/assets/a92082fb-6b2d-4567-9397-b24601349278)

pada web ini karena diminta berikan ip, maka saya berikan saja ip asal `127.0.0.1` untuk melihat bagaimana web nya bereaksi

![pink2](https://github.com/user-attachments/assets/61f10182-68ca-42a9-81c7-f16e7d015050)

ternyata web hanya mengeluarkan data ping seperti data pada saat kita melakukan ping pada command prompt. 
Dari pengalaman saya, biasanya dalam memberikan command seperti ini pada input box, saya bisa memberikan `;` agar dapat terpisah dari command pingnya dan memasukkan
payload command saya, biasanya hal ini dapat terlaksana pada website yang tidak mempunyai sanitazion yang baik.

Maka saya langsung memasukkan command `127.0.0.1;ls` dan hasilnya seperti gambar dibawah

![pink3](https://github.com/user-attachments/assets/6357e3c2-f31b-4250-ac70-89e546e3e0fc)

Disini karena saya lihat tidak bisa diinject begitu saja, saya mencobanya di burpsuite dengan mengintercept websitenya dan melihat bagaimana background web nya bekerja

![pink4](https://github.com/user-attachments/assets/4dd7d29a-596e-416e-b75a-913698c6667b)

Saya masukkan ke repeater dan saya coba command yang sama (`127.0.0.1;ls`)

![pink5](https://github.com/user-attachments/assets/1ea31397-6462-4fbb-ad5e-5c3c3fbd82e4)

ternyata hasilnya sama saja. Saya baru teringat bahwa ada beberapa ban list yang dimasukkan ke dalam source code nya

![image](https://github.com/user-attachments/assets/5c07c24c-4621-4b0b-9590-696be52ebe6e)

Saya baru menyadari bahwa alasan saya tidak bisa melakukan `127.0.0.1;ls` karena `;` ada di dalam ban list. Dari sini saya langsung mencoba mencari cara bagaimana untuk mengbypass nya. Saya menemukan suatu cara apabila untuk mengbypass blacklist ini salah satunya adalah dengan `\n` atau cukup menekan `enter` pada keyboard, maka saya langsung coba praktekan dengan menekan enter setelah ip (diantara 127.0.0.1 dan ls) pada burpsuite dan hasilnya seperti gambar dibawah

![pink6](https://github.com/user-attachments/assets/6fa6adab-96a5-4de9-9ec7-aa48ec5a2c80)

Dari sini saya berhasil mengbypass blacklist nya dan bisa melihat file flag.txt, maka saya langsung lakukan command `cat flag.txt` dan berhasil memberikan saya flag dari challenge ini

![pink7](https://github.com/user-attachments/assets/9732f889-8426-41cc-a780-1c31b1c1d8ef)

**FLAG:** `COMPFEST16{bj1rrr_1njEKs1_p3rInTAH_96530087aa}`

# **Baby Rizztekin**

Pada chall ini saya diberikan sebuah web seperti gambar dibawah

![baby1](https://github.com/user-attachments/assets/e9e65b0e-21de-4d76-9cf9-88add2e92783)

dan souce code dari web tersebut

![image](https://github.com/user-attachments/assets/bfae8970-6665-431d-b559-80d08f0f2780)

Pada saat saya memencet tombol login, saya diarahkan ke login page yang berisi username dan password. 
Dari pengalaman saya, biasanya saya dapat melakukan `SQL Injection` yang mana dapat mengbypass login systemnya dan masuk ke dalam website nya

Maka saya langsung isi username dengan  payload `' OR 1=1 -- -` dan password `1`

**NOTE: PASSWORD DARI SETIAP PERCOBAAN AKAN TETAP SAMA YAITU `1`**

![baby2](https://github.com/user-attachments/assets/659ce07b-0270-4d58-8c2f-6e0eb49e2527)

Ternyata dari SQL Injection saya tersebut, saya berhasil masuk sebagai `rorre`. Dari pengalaman saya, biasa saya mencoba payload lain seperti `' OR 1=1 LIMIT 1 -- -` untuk melihat bagaimana login page bereaksi terhadap payload yang berbeda

![baby3](https://github.com/user-attachments/assets/2e51a7dd-f6d4-4c15-93b4-a997c75efa07)

Ternyata sama saja seperti payload sebelumnya. Saya mencoba memahami bagaimana cara kerja payload yang saya pakai dan mengapa hasilnya rorre.

Saat saya mencoba melihat di source code ternyata ada user lain yang bernama meervix

![image](https://github.com/user-attachments/assets/e0e88d6b-a713-4315-aa6a-9cd12a150377)

Dan juga pada code tersebut, terdapat beberapa SQL query yang menunjukkan bahwa database ini bentuknya seperti table data pada umumnya.

Maka saya langsung terpikirkan satu cara yaitu `OFFSET` yang mana kerja nya yaitu dengan memilih per row table seperti misalkan `OFFSET 0` memilih table row 1 dan `OFFSET 1` memilih table row 2 dan seterusnya

Maka saya langsung masukkan payload `' OR 1=1 LIMIT 1 OFFSET 0 -- -` dan hasilnya seperti dibawah

![baby4](https://github.com/user-attachments/assets/724c605f-7382-44b6-9452-10ec6813d92d)

Ternyata masih rorre (sesuai perkiraan saya bahwa rorre ada pada table row 1)

Saya coba `' OR 1=1 LIMIT 1 OFFSET 1 -- -`

![baby5](https://github.com/user-attachments/assets/9240f56c-d8ee-4192-a75c-26bb9de1e74e)

dan ternyata betul saja saya bisa mendapatkan `meervix`, disini saya menebak nebak, apabila table data row 3 adalah tempat data admin berada yang mana saya harus memasukkan `OFFSET 2`.

Maka saya langsung masukkan payload `' OR 1=1 LIMIT 1 OFFSET 2 -- -` yang berhasil membuat saya mendapatkan flag dari challenge ini

![baby6](https://github.com/user-attachments/assets/599e2f84-e090-4097-bcdb-233196ce7b7d)

**FLAG:** `COMPFEST16{aLw4Ys_uS3_pr3P4reD_st4tEm3NTS_e3ae331a90}`

# **Greet Your Friend**

Pada chall ini saya diberikan sebuah web seperti gambar dibawah

![greet1](https://github.com/user-attachments/assets/50993a85-9581-4af5-beee-64d1cb7cac98)

dan source code seperti gambar dibawah

![image](https://github.com/user-attachments/assets/0af54faa-a34a-4db5-b5c2-687933c796af)

Saya mencoba memasukkan input asal seperti `haha` saya mendapatkan greetings pada websitenya (saya lupa ss maaf hehehe). Namun pada url bar nya, saya melihat apabila inputan saya tersimpan dalam sebuah variable `name` link ini `http://challenges.ctf.compfest.id:20009/?name=haha`

dari sini saya langsung terpikirkan bahwa payload yang saya mau inject kemungkinan bisa saya sisipkan dalam variable name tersebut.

Melalui channel discord COMPFEST16, saya mendapatkan clue bahwa challenge ini akan bermain pada daerah `SSTI (Server Side Template Injection)`

![image](https://github.com/user-attachments/assets/393bdfa5-8177-4147-8676-28c4ec502c4b)

saya langsung melakukan searching di google tentang SSTI CTF write up yang mana menghantarkan saya pada (link)[https://medium.com/@Fcmam5/ctf-as-a-developer-pt-1-template-engines-ssti-b03c59e2c095] ini

Dari write up tersebut, saya melihat apabila case yang dihadapi cukup serupa, maka saya dapat mengambil inspirasi payload dari write up tersebut.

Saya melihat apabila payload yang digunakan adalah `{{request.application.__globals__.__builtins__.__import__('os').popen('ls -R').read()}}`. Disini saya sadar bahwa dalam source code, command `read` di ban sehingga tidak dapat digunakan

![image](https://github.com/user-attachments/assets/1b8ccafb-2b18-4b63-bcfa-d24f6dfb6419)

Maka saya mencoba slicing command sedikit sedikit dengan memasukkan command `{{request.application.__globals__.__builtins__.__import__('os')}}` terlebih dahulu untuk melihat apa yang dikeluarkan oleh website

![greet2](https://github.com/user-attachments/assets/f6854683-59a4-475d-a523-50f87fdb69f0)

Ternyata command tersebut hanya mengeluarkan file OS yang digunakan website. Langsung saya mencoba memasukkan command `{{request.application.__globals__.__builtins__.__import__('os').popen('ls -R')}}` untuk melihat apa yang dapat ditampilkan

![greet3](https://github.com/user-attachments/assets/55af5de8-da59-404c-973d-2cf50244592e)

ternyata hanya mengeluarkan memory addres dari suatu file. Disini saya paham bahwa ada suatu file yang harus dibaca, namun saya harus mengakali command read nya agar dapat membaca file tersebut. Setelah saya coba cari cari cara, saya bisa menggunakan command `{{request.application.__globals__.__builtins__.__import__('subprocess').check_output('ls -R', shell=True).decode()}}` (maaf saya lupa ss lagi).

Dari command ini saya bisa melisting beberapa file dan salah satunya adalah `main.py`, seperti yang saya ketahui melalui source code bahwa flag nya bisa saya temukan dari source code yang diberikan dengan nama `main.py`

![image](https://github.com/user-attachments/assets/21c028ba-08e0-4433-a319-9a5db022a0ce)

Maka dari itu saya perlu melakukan `cat` command (kebetulan cat tidak di ban) pada file `main.py` untuk mendapatkan flag nya. Maka command nya saya ganti menjadi `{{request.application.__globals__.__builtins__.__import__('subprocess').check_output('cat main.py', shell=True).decode()}}` yang mana berhasil membawa saya pada flag dari challenge ini

![greet4](https://github.com/user-attachments/assets/dd522442-c57c-4c28-ad0b-30192ac2a724)

**FLAG:** `COMPFEST16{b3St_fw3nDS_for3v3R_dcb3980048}`
