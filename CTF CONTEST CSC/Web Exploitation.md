# **Math AI**

In this challenge i was given a calculator website

![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/615ab203-6595-484d-81e3-b12971996ce9)

i tried to do command injection like `ls` but nothing really worked. So then i tried to open the page source of this web to do scanning on the code of this website

![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/f0c9cb72-74d5-49ba-96fb-c610d50b8b3f)

In the page source, there are several links for the backend of this website but there are only 2 interesting link.

The first link (`https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval`) connects to a mozilla website which is a clue to solve this challenge.
In this website i was given an explanation about `eval()` function which then i tried it on the math website

![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/b91f0428-3909-479d-ab7d-b149ebd9f19a)

at first i was a bit confused what to do with this function, but then i tried to input a `eval('2 + 2') == eval('2 + 2')` function

![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/9b82a411-7fc3-4c1e-82b1-a23b677b6f94)

It turns out returned a `true` condition which means that this calculator web is not just to count numbers, but can execute a JS command.

So then i entered the second link which gave me the JS script of the website

![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/6b9be489-afba-48b7-9014-490ad4f15e51)

At first i tried to understand the JS and tried several eval function but nothing really works,
i tried to search `javascript injection eval` on google which then took me to this [link](https://vk9-sec.com/exploiting-javascript-eval-code-injection/).

When i analyze the website, it turned out to be the same exact website with this challenge which then i tried to analyze more further.

In the website, the author also tried to understand how the website works which then the author tried to execute JS function

`process.platform`
![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/dea90e8a-e60c-42c9-a492-f4f99677fb53)

`process.cwd()`
![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/0b342c30-7dc0-48c6-9b03-d676fd671c31)

From the test above, i could see that the JS function works just like the `eval()` function and from there we could also see the platform it is running (`linux`) and the current working directory(`/app`)

After that the author of the website tried another function which is `require('child_process').execSync('ls -l').toString()`.
Even the author gave several explanation about each part of the function:
1. `require('child_process')`: imports the child_process module which allow the machine to execute external commands
2. `execSync('ls -l')`: execute shell command which in this case execute `ls -l` to list the contents of current directory in long format
3. `toString()`: since the execSync result is in a buffer, `toString()` function will convert the buffer to a string

The author wants to execute this command(`require('child_process').execSync('ls -l').toString()`) because the author wants to see all list of contents from directory `/app` which might contains vulnerable data.
The author imports the `child_process` module to make `execSync` works since that command comes from that module and use `toString()` function to convert buffer to string.

When i execute the command, it gave me the flag of this challenge

![image](https://github.com/Bepe2306/CTF-Write-Up/assets/153899054/fd0fc017-0ec4-49cb-a8ff-a419e94a69a8)

**FLAG:** `CSC{4Ku_4dal4h_fl49ny4_h4hihUh3hO}`
